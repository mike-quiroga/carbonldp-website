<%var versionSelected = page.version? page.version: theme.versions.current; %>
<%var categoriesList = site.data["documentation-list"].categories;%>
<%var path, categorySlug;%>
<%var versionsPerDocument = site.data["versions-per-document"];%>
<%var versionsThatApply = versionsPerDocument[page.title]? versionsPerDocument[page.title]:theme.versions.allVersions;%>

<%for( var i in categoriesList){
	if( categoriesList[i].title === page.title ){
		path = categoriesList[i].link?categoriesList[i].link+"/":"";
		break;
	} else {
		for( var j in categoriesList[ i ].versions ) {
			if( categoriesList[ i ].versions[ j ].version == versionSelected ) {
				for( var k in categoriesList[ i ].versions[ j ].documents ) {
					if( categoriesList[ i ].versions[ j ].documents[ k ].title === page.title ) {
						categorySlug = categoriesList[i].link? categoriesList[i].link+"/":"";
						path = categorySlug+ "/" + categoriesList[ i ].versions[ j ].documents[ k ].link+"/";
						break;
					}
				}
			}
		}
	}
}
if(typeof path === "undefined") path = ""; %>

<div class="ui dropdown versionsMenu-dropdown <%=containerDarkBackground? "" : "versionsMenu-dropdown--blackText"%>">
	<button class="default text ui button versionsMenu-button <%=containerDarkBackground? "" : "versionsMenu-button--grayHover"%>"><%= versionSelected %></button>
	<div class="ui menu versionsMenu">
	<%for ( var i in theme.versions.allVersions ){%>
			<%var itemAdded=false;%>
			<%for ( var j in versionsThatApply ){
				if( theme.versions.allVersions[i] === versionsThatApply[j] ){%>
					<a class="item" href="<%-url_for("documentation/"+theme.versions.allVersions[j]+"/"+path)%>"><%= versionsThatApply[j]%></a>
					<%
					itemAdded=true;
					continue;
				}%>
			<%}
			if (!itemAdded){
				path = categorySlug? categorySlug: "";%>
				<a class="item" href="<%-url_for("documentation/"+theme.versions.allVersions[j]+"/"+path)%>"><%= theme.versions.allVersions[i]%></a>
			<%}
		 }%>
	</div>
</div>